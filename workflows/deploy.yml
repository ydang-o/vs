- name: Build backend
  working-directory: partner-voting-server
  run: mvn clean package -DskipTests

- name: Upload jar to server
  uses: appleboy/scp-action@v0.1.7
  with:
    host: ${{ secrets.SERVER_HOST }}
    username: ${{ secrets.SERVER_USER }}
    key: ${{ secrets.SERVER_SSH_KEY }}
    source: "partner-voting-server/target/*.jar"
    target: "/opt/app"

- name: Restart backend container
  uses: appleboy/ssh-action@v1.0.0
  with:
    host: ${{ secrets.SERVER_HOST }}
    username: ${{ secrets.SERVER_USER }}
    key: ${{ secrets.SERVER_SSH_KEY }}
    script: |
      cd /opt/app
      docker compose restart backend
